<div class="home-container">
    <h1>Welcome to Your Home Page, <%= user.username %>!</h1>
    <p>Email: <%= user.email %></p>
    
    <!-- Search Form -->
    <form action="/home/search" method="GET" class="search-form">
        <input type="text" name="query" placeholder="Search for creators..." required>
        <button type="submit">Search</button>
    </form>

    <a href="/profile" class="home-profile-link">Go to Profile</a>
    <a href="/logout" class="home-logout-link">Log out</a>
    
    <!-- Display search results here -->
    <div class="search-results">
        <% if (creators && creators.length > 0) { %>
            <h2>Search Results for "<%= search %>":</h2>
            <ul>
                <% creators.forEach(creator => { %>
                    <!-- Updated link to view other user's profile -->
                    <li><a href="/profile/view/<%= creator._id %>"><%= creator.username %></a></li>
                <% }) %>
            </ul>
        <% } else if (creators && creators.length === 0) { %>
            <p>No creators found matching "<%= search %>."</p>
        <% } else { %>
            <p>No search results to display.</p>
        <% } %>
    </div>

    <!-- New Section: Subscribed Creators' Posts -->
    <div class="subscribed-content">
        <h2>Your Subscribed Creators' Posts</h2>
        <% if (subscribedCreators && subscribedCreators.length > 0) { %>
            <% subscribedCreators.forEach(creator => { %>
                <div class="creator-section">
                    <h3>
                        <a href="/profile/view/<%= creator._id %>">
                            <%= creator.username %>
                        </a>'s Posts
                    </h3>
                    <% if (creator.uploadedContent && creator.uploadedContent.length > 0) { %>
                        <div class="creator-posts">
                            <% creator.uploadedContent.forEach(post => { %>
                                <div class="post-item">
                                    <% if (post.type === 'image') { %>
                                        <img src="<%= post.filename %>" alt="Post Image">
                                    <% } else if (post.type === 'video') { %>
                                        <video controls>
                                            <source src="<%= post.filename %>" type="video/mp4">
                                            Your browser does not support the video tag.
                                        </video>
                                    <% } %>
                                    <% if (post.writeUp) { %>
                                        <p class="post-writeup"><%= post.writeUp %></p>
                                    <% } %>
                                </div>
                            <% }); %>
                        </div>
                    <% } else { %>
                        <p>No posts yet.</p>
                    <% } %>
                </div>
            <% }); %>
        <% } else { %>
            <p>You are not subscribed to any creators yet.</p>
        <% } %>
    </div>
</div>
